server {
  listen 80;
  server_name _;

  # /app1 → /app1/
  location = /app1 { return 301 /app1/; }
  location /app1/ {
    proxy_set_header Host $host;
    proxy_set_header X-Forwarded-Proto $scheme;
    proxy_set_header X-Forwarded-Prefix /app1;
    proxy_pass http://app1:3000/;
  }

  # /app2 → /app2/
  location = /app2 { return 301 /app2/; }
  location /app2/ {
    proxy_set_header Host $host;
    proxy_set_header X-Forwarded-Proto $scheme;
    proxy_set_header X-Forwarded-Prefix /app2;
    proxy_pass http://app2:3000/;
  }
}
